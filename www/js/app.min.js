angular.module("Feiyi",["ngRoute","LocalStorageModule","flow"]).config(["$routeProvider","$httpProvider","$locationProvider","localStorageServiceProvider","config",function(e,t,o,n,r){angular.forEach(r.interceptor,function(t){var o=t.replace(/_[a-z]/g,function(e){return e.split("_")[1].toUpperCase()});o+="Controller",e.when("/"+t,{templateUrl:"templates/"+t+".html",reloadOnSearch:!1,controller:o,resolve:{user:["$q","$location","localStorageService",function(e,o,n){var r=["account"],i=e.defer();return r.includes(t)&&!n.get("token")?(i.reject(),o.path("/signin").replace(),void 0):(i.resolve(),i.promise)}]}})}),e.otherwise("/index"),t.defaults.useXDomain=!0,t.defaults.withCredentials=!0,delete t.defaults.headers.common["X-Requested-With"],n.setStorageCookie(.02),t.interceptors.push("tokenInterceptor")}]).run(["appServices",function(e){e.init()}]),angular.module("Feiyi").factory("weixinServices",["$http","$route","$timeout","$rootScope","$location","toastServices","$q","$window","localStorageService","config",function(e,t,o,n,r,i,a,s,c,u){function l(e,t,o,n){wx.onMenuShareTimeline({title:e||p.share.title,link:t||p.share.link,imgUrl:o||p.share.thumbnail,trigger:function(){},success:function(){},cancel:function(){}}),wx.onMenuShareAppMessage({title:e||p.share.title,desc:n||p.share.desc,link:t||p.share.link,imgUrl:o||p.share.thumbnail,type:"link",dataUrl:"",success:function(){},cancel:function(){}}),wx.onMenuShareQQ({title:e||p.share.title,desc:n||p.share.desc,link:t||p.share.link,imgUrl:o||p.share.thumbnail,success:function(){},cancel:function(){}}),wx.onMenuShareWeibo({title:e||p.share.title,desc:n||p.share.desc,link:t||p.share.link,imgUrl:o||p.share.thumbnail,success:function(){},cancel:function(){}}),wx.onMenuShareQZone({title:e||p.share.title,desc:n||p.share.desc,link:t||p.share.link,imgUrl:o||p.share.thumbnail,success:function(){},cancel:function(){}})}var d=s.navigator.userAgent.toLowerCase();n.wx_browser=-1!=d.indexOf("micromessenger")?!0:!1;var p={base_url:"https://open.weixin.qq.com/connect/oauth2/authorize",access_token_url:"https://api.weixin.qq.com/sns/oauth2/access_token",userinfo_url:"https://api.weixin.qq.com/sns/userinfo",appid:"wx3fb7ab3b189c4320",secret:"d6252a7ccab0d59bb481414565cdafff",redirect_uri:"http://www.orsynsystem.com/oauth",payment_redirect_uri:"http://www.orsynsystem.com/app/WeixinCommon/weixinPay",response_type:"code",scope:"snsapi_userinfo",state:"weixin",wechat_redirect:"#wechat_redirect",share:{}};return{config:function(){return this.query_signature({current_url:r.absUrl().split("#")[0]}).then(function(e){e.code==u.request.SUCCESS&&e.status==u.response.SUCCESS&&wx.config({debug:!1,appId:p.appid,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","chooseWXPay","chooseImage","uploadImage"]})})},query_signature:function(t){return e({url:u.url+"/app/WeixinCommon/getSignature",method:"GET",params:angular.extend({},u.common_params,t)}).then(function(e){return e.data})},query_payment_signature:function(t){return e({url:u.url+t.signature_url,method:"GET",params:angular.extend({},u.common_params,t)}).then(function(e){return e.data})},initWeixinShareEvent:function(e,t,o,n){l(e,t,o,n)},queryAuthorizationCode:function(){var e=p.base_url+"?appid="+p.appid+"&redirect_uri="+encodeURIComponent(p.redirect_uri)+"&response_type="+p.response_type+"&scope="+p.scope+"&state="+p.state+p.wechat_redirect;s.location.href=e},queryAuthorizationCodeSilently:function(e){e=angular.extend({},e);var t=p.base_url+"?appid="+p.appid+"&redirect_uri="+encodeURIComponent(e.redirect_uri)+"&response_type="+p.response_type+"&scope="+p.scope+"&state="+JSON.stringify(e)+p.wechat_redirect;s.location.href=t},prepare_pay:function(e){e=angular.extend({},e,{redirect_uri:p.payment_redirect_uri}),this.queryAuthorizationCodeSilently(e)},pay:function(e){i.show(),wx.chooseWXPay({timestamp:e.timestamp,nonceStr:e.nonceStr,"package":e.package_web,signType:e.signType,paySign:e.paySign,success:function(){i.hide(),o(function(){s.location.href=r.protocol()+"://"+r.host()+":"+r.port()+"/mobile/#/order_management_user"},1e3)},cancel:function(){i.hide(),o(function(){n.back()},1e3)},fail:function(){i.hide(),o(function(){n.back()},1e3)}})},choose_image:function(e,t){var t=t||angular.noop;wx.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var o=e.localIds;t(o)}})},upload_image:function(e,t){var t=t||angular.noop;wx.uploadImage({localId:e.localId,isShowProgressTips:1,success:function(e){var o=e.serverId;t(o)}})}}}]),angular.module("Feiyi").factory("utilServices",["$q",function(e){var t=function(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var o=e.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return new Blob([n],{type:o})},o=function(o){var n=e.defer(),r=document.createElement("img");try{var i=new FileReader;i.onload=function(e){r.src=e.target.result;var o=document.createElement("canvas"),i=o.getContext("2d");i.drawImage(r,0,0);var a=500,s=500,c=r.width,u=r.height;c>u?c>a&&(u*=a/c,c=a):u>s&&(c*=s/u,u=s),o.width=c,o.height=u;var i=o.getContext("2d");i.drawImage(r,0,0,c,u);var l=o.toDataURL("image/jpeg"),d=t(l);n.resolve(d)},i.readAsDataURL(o)}catch(a){n.resolve(a)}return n.promise};return{resizeFile:o}}]),angular.module("Feiyi").factory("userServices",["$rootScope","$http","apiServices","localStorageService","config",function(e,t,o,n,r){return{rsa_key:o._get(angular.extend({},r.common_params,{url:"key/private_key.pem"})),signin:o._get(angular.extend({},r.common_params,{url:r.url+"api_url"})),signup:o._get(angular.extend({},r.common_params,{url:r.url+"/app/UserCenter/RegistTelOne",token:n.get("token")})),update_telephone:o._get(angular.extend({},r.common_params,{url:r.url+"/app/UserCenter/updateTelephone",token:n.get("token")})),forget:o._get(angular.extend({},r.common_params,{url:r.url+"api_url"})),reset:o._get(angular.extend({},r.common_params,{url:r.url+"api_url"})),get_smscode:o._get(angular.extend({},r.common_params,{url:r.url+"/app/OrdersManage/getCode",token:n.get("token")})),query_city:o._get(angular.extend({},r.common_params,{url:"city/city_with_index.json",token:n.get("token")})),query_inter_city:o._get(angular.extend({},r.common_params,{url:"city/inter_city_with_index.json",token:n.get("token")})),booking:o._get(angular.extend({},r.common_params,{url:r.url+"/app/OrdersManage/makeOrder",token:n.get("token")})),booking_by_doctory_id:o._get(angular.extend({},r.common_params,{url:r.url+"/app/OrdersManage/submitOrder",token:n.get("token")})),query_doctors:o._get(angular.extend({},r.common_params,{url:r.url+"/app/Home/recommendDoctorList",token:n.get("token")})),query_doctor_by_id:o._get(angular.extend({},r.common_params,{url:r.url+"/app/Home/doctorInfo",token:n.get("token")})),query_comment_by_doctor:o._get(angular.extend({},r.common_params,{url:r.url+"/app/Home/commentList",token:n.get("token")})),query_orders:o._get(angular.extend({},r.common_params,{url:r.url+"/app/OrdersManage/myOrderList",token:n.get("token")})),comment:o._get(angular.extend({},r.common_params,{url:r.url+"/app/Home/comment",token:n.get("token")})),donate:o._get(angular.extend({},r.common_params,{url:r.url+"/app/OrdersManage/giveJinqi",token:n.get("token")})),upload:o._get(angular.extend({},r.common_params,{url:r.url+"/app/OrdersManage/downWeixinImg",token:n.get("token")})),query_hospitals:o._get(angular.extend({},r.common_params,{url:r.url+"/app/Home/hospitalList",token:n.get("token")}))}}]),angular.module("Feiyi").factory("tokenInterceptor",["$location","$q","localStorageService","errorServices","config",function(e,t,o,n,r){return{request:function(e){return e},requestError:function(){},response:function(n){var i=t.defer();return n.config.url.indexOf(".html")>0?n:n.data.code==r.request.TOKEN_INVALID?(console.log("TOKEN_INVALID"),o.remove("token"),o.remove("user_id"),e.path("/interpreter_settled").replace(),i.promise):n},responseError:function(e){var o=t.defer();return n.requestError(e.data,e.status,e.headers,e.config),o.promise}}}]),angular.module("Feiyi").factory("toastServices",function(){return{show:function(){$(".toast").show()},hide:function(){$(".toast").hide()},start:function(){NProgress.start()},done:function(){NProgress.done()}}}),angular.module("Feiyi").factory("feiyiServices",["$rootScope","$http","apiServices","localStorageService","config",function(e,t,o,n,r){return{query_information_by_type:o._get(angular.extend({},r.common_params,{url:r.url+"/app/NewsManage/newsList"})),query_information_by_id:o._get(angular.extend({},r.common_params,{url:r.url+"/app/NewsManage/newsDetail"})),query_province:o._get(angular.extend({},{url:"city/province.json"})),query_city:o._get(angular.extend({},{url:"city/city.json"})),query_province_city_district:o._get(angular.extend({},{url:"city/province_city_district.json"}))}}]),angular.module("Feiyi").factory("errorServices",["$rootScope","$timeout","toastServices",function(e,t,o){return{show:function(t){e.error_msg=t,$(".error-msg").show()},hide:function(){e.error_msg="",$(".error-msg").hide()},autoHide:function(o){e.error_msg=o,$(".error-msg").show(),t(function(){e.error_msg="",$(".error-msg").hide()},3e3)},requestError:function(n,r,i,a){switch(o.hide(),r){case 0:this.autoHide("连接超时");break;case 404:this.autoHide("加载出错，请稍后再试"),t(function(){e.back()},2e3);break;case 500:case 501:case 502:case 503:case 504:case 505:case 506:case 507:case 509:case 510:this.autoHide("服务器连接出错")}console.log("onRequestError output status, data, headers, config"),console.log(r),console.log(n),console.log(i),console.log(a),console.log("onRequestError end")}}}]),angular.module("Feiyi").factory("appServices",["$rootScope","$window","$location","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a){var s=function(){},c=function(e,t,o){r.hide(),n.hide(),l(e,t,o)},u=function(){},l=function(){};return{init:function(){e.$on("$routeChangeStart",s),e.$on("$routeChangeSuccess",c),e.$on("$routeChangeError",u),e.go=function(e){o.path(e)},e.back=function(){t.history.back()},"8000"==o.port()&&i.set("token","oeZT9s0s0P1-s5Ns7nQOxfUldSk3"),e.staticImageUrl=a.imageUrl}}}]),angular.module("Feiyi").factory("apiServices",["$http","localStorageService",function(e,t){return{_get:function(o){return function(n){return void 0!==o.token&&(o.token=t.get("token")),e({url:o.url,method:"GET",params:angular.extend({},o,n)}).then(function(e){return e.data})}},_post:function(o){return function(n){return void 0!==o.token&&(o.token=t.get("token")),e({url:o.url,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(e){var t=[];for(var o in e)t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return t.join("&")},data:angular.extend({},o,n)}).then(function(e){return e.data})}}}}]),angular.module("Feiyi").directive("uploader",["$timeout","localStorageService","toastServices","errorServices","config",function(e,t,o,n,r){return{restrict:"E",template:function(e,t){var o="",n=t.rate;return o="<imageview center-only data-rate='"+n+"' src='src'></imageview>"},controller:["$scope","$element","$attrs",function(e,n,i){var a,s;e.$on("flow::filesSubmitted",function(e,n){n.files[0].name.replace(/.png|.jpg|.jpeg|.gif/g,function(e){return s=e,e});var i=Math.floor(1e6*Math.random())+s;a=(new Date).getTime()+i,n.opts.target=r.url+"/app/UserCenter/updatePic",n.opts.testChunks=!1,n.opts.fileParameterName="image_01",n.opts.query={invoke:"h5",token:t.get("token"),filename:a},o.show(),n.upload()}),e.$on("flow::fileAdded",function(){}),e.src="../images/default.png",i.default&&(e.src=i.default),i.$observe("src",function(t){t&&(e.src=r.imageUrl+t)}),e.$on("flow::fileSuccess",function(){e.src=r.imageUrl+a,o.hide()})}],link:function(){}}}]),angular.module("Feiyi").directive("showOnLoaded",function(){return{link:function(e,t){$(t).css({visibility:"hidden"}),t.bind("load",function(){var o=parseFloat(e.$eval($(t).parent().attr("data-rate")));if(!o)return console.log("unexpect rate"),void 0;var n=$(t).width()/$(t).height();o>n?$(t).css({height:"100%",width:"auto"}):$(t).css({height:"auto",width:"100%"}),$(t).parent().css({background:"none"}),$(t).css({visibility:"visible"})})}}}),angular.module("Feiyi").directive("pagetitle",["$document",function(e){return{restrict:"E",scope:{title:"="},link:function(t){e[0].title=t.title;var o=$("body"),n=$('<iframe src="/favicon.ico" style="display:none"></iframe>');n.on("load",function(){setTimeout(function(){n.off("load").remove()},0)}).appendTo(o)}}}]),angular.module("Feiyi").directive("onRepeatDone",function(){return{restrict:"A",link:function(e,t){e.$last&&e.$emit("onRepeatDone",t)}}}),angular.module("Feiyi").directive("onload",function(){return{restrict:"A",link:function(e,t){$(t).css({opacity:0}),$(t).bind("load",function(){$(t).css({opacity:1})})}}}),angular.module("Feiyi").directive("mobilepicker",["$timeout",function(e){return{restrict:"E",scope:{options:"="},template:"<input type='text' name='picker' placeholder='{{options.placeholder}}' class='full-width' readonly ng-model='options.value'>",link:function(t,o){var n={beginyear:1950,endyear:(new Date).getFullYear(),days:["周日","周一","周二","周三","周四","周五","周六"],curdate:!1,theme:"date",event:"click",today:!1,callBack:function(e){var o="";for(key in e)e[key]&&(o+=e[key]+"-");o=o.substring(0,o.length-1),t.options.value=o}};e(function(){$(o).find("input").datePicker(angular.extend({},n,t.options))},0)}}}]),angular.module("Feiyi").directive("imageview",["$timeout",function(e){return{restrict:"E",scope:{src:"=",err:"=?"},controller:["$scope","$element","$attrs",function(t,o,n){function r(e){$(e.target).css({width:"auto",height:"auto"});var o=$(e.target),n=o.width(),r=o.height(),i=parseFloat(n)/parseFloat(r);i<t.rate?(n=t.width,r=t.width/i,o.css({display:"inline-block",height:r,width:n,"margin-top":-(r-t.height)/2})):(r=t.height,n=r*i,o.css({display:"inline-block",height:r,width:n,"margin-left":-(n-t.width)/2})),o.parent().css({background:"none"}),o.css({visibility:"visible"})}function i(e){var o=$(e.target),n=o.width(),r=o.height(),i=parseFloat(n)/parseFloat(r);i>t.rate?o.css({display:"inline-block",height:"100%",width:"auto"}):o.css({display:"inline-block",height:"auto",width:"100%"}),o.parent().css({background:"none"}),o.css({visibility:"visible"})}return t.bg_image=t.err||"../images/default.png",t.rate=parseFloat(t.$eval(n.rate)),t.width=o.parent().width()||$(window).width(),t.height=t.width/t.rate,t.rate?(this.show_center_on_loaded=function(t){r(t),e(function(){r(t)},100)},this.show_on_loaded=function(t){i(t),e(function(){i(t)},100)},void 0):(console.log("unexpect rate"),void 0)}],template:function(e){var t="<img ng-src='{{src}}' show-center-on-loaded err-src='{{bg_image}}'>";return void 0==$(e).attr("center-only")&&(t="<img ng-src='{{src}}' show-on-loaded err-src='{{bg_image}}'>"),t},link:function(e,t){var o={display:"block",width:e.width,overflow:"hidden","text-align":"center","background-image":"url("+e.bg_image+")","background-position":"center center","background-repeat":"no-repeat",height:e.height,overflow:"hidden"};$(t).css(o)}}}]).directive("showOnLoaded",function(){return{restrict:"A",require:"^imageview",link:function(e,t,o,n){t.bind("load",n.show_on_loaded)}}}).directive("showCenterOnLoaded",function(){return{restrict:"A",require:"^imageview",link:function(e,t,o,n){t.bind("load",n.show_center_on_loaded)}}}),angular.module("Feiyi").directive("dribehanceHeader",function(){return{restrict:"E",templateUrl:"templates/header.html",scope:{title:"=",backAction:"="},link:function(){}}}),angular.module("Feiyi").directive("dribehanceFooter",function(){return{restrict:"E",templateUrl:"templates/footer.html",scope:{active:"="},link:function(){}}}),angular.module("Feiyi").directive("errSrc",function(){return{restrict:"A",link:function(e,t,o){$(t).bind("error",function(){$(t).attr("src",o.errSrc)})}}}),angular.module("Feiyi").directive("countdown",["$interval",function(e){return{restrict:"E",scope:{countdown:"=",disabled:"=countdownDisabled"},link:function(t,o){function n(){var o=t.countdown.message,n=parseFloat(t.countdown.count)?parseFloat(t.countdown.count):60;r=!0,t.$apply(function(){t.countdown.message=n--,t.countdown.message=n+"s重新获取",t.countdown.mode="disabled",t.countdown.reset=!1,t.countdown.callback()});var i=e(function(){t.countdown.message=n--,t.countdown.message=n+"s重新获取",(0>n||t.countdown.reset)&&(e.cancel(i),t.countdown.message=o,r=!1)},1e3)}var r=!1;$(o).bind("click",function(){t.disabled||r||n()})}}}]),angular.module("Feiyi").directive("confirm",function(){return{restrict:"E",scope:{confirm:"="},templateUrl:"templates/confirm.html",link:function(e,t){e.confirm=angular.extend({},{title:"Tips",content:"Are You Sure?",content_type:"content",open:function(){$(t).show()},cancel:function(){$(t).hide(),"function"==typeof e.confirm.cancle_callback&&e.confirm.cancle_callback()},ok:function(){$(t).hide(),"function"==typeof e.confirm.ok_callback&&(e.confirm.ok_callback(),e.confirm.content_type="content")}},e.confirm)}}}),angular.module("Feiyi").directive("banner",function(){return{restrict:"E",transclude:!0,template:"<div class='carousel-holder owl-carousel theme' ng-transclude></div>",link:function(e,t){var o={autoplay:!0,items:1};o=angular.extend({},o,e.$eval($(t).attr("data-options")));var n=parseFloat(e.$eval($(t).attr("data-rate"))),r={display:"block",width:$(t).parent().width()||$(window).width(),height:($(t).parent().width()||$(window).width())/n};$(t).css(r),e.$on("onRepeatDone",function(){$(t).find(".carousel-holder").owlCarousel(o)})}}}),angular.module("Feiyi").controller("weixinController",["$scope","$rootScope","$location","$timeout","weixinServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a,s,c){t.wx_browser&&r.config().then(function(){a.show(),r.query_payment_signature({give_jinqi_id:s.get("give_jinqi_id"),orders_id:s.get("orders_id"),code:s.get("code"),signature_url:s.get("signature_url")}).then(function(e){a.hide(),e.code==c.request.SUCCESS&&e.status==c.response.SUCCESS?r.pay(e):t.back()})})}]),angular.module("Feiyi").controller("signinController",["$scope","$timeout","$location","userServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a,s){e.input={},e.countdown={message:"获取验证码"},e.countdown.callback=function(){i.show(),n.get_smscode({telephone:e.input.telephone,country_code:e.input.country_code.code}).then(function(t){i.hide(),t.code==s.request.SUCCESS&&t.status==s.response.SUCCESS?r.autoHide(t.message):(e.countdown.reset=!0,r.autoHide(t.message))})},e.ajaxForm=function(){return e.agree?(i.show(),n.signup({country_code:e.input.country_code.code,telephone:e.input.telephone,tel_code:e.input.code,weChat:e.input.wechat}).then(function(e){i.hide(),e.code==s.request.SUCCESS&&e.status==s.response.SUCCESS?(r.autoHide(e.message),a.set("token",e.token),t(function(){o.path("information").replace()},2e3)):r.autoHide(e.message)}),void 0):(r.autoHide("请阅读并同意《译员协议》"),void 0)},e.input.country_code={name:"中国",code:"+86"},e.agree=!1,e.is_agree=function(){e.agree=!e.agree},e.cache_and_go=function(t,n){a.set("cache",e.input),o.path(t).search("cache_key",n)};var c=a.get("cache");c&&(e.input=angular.extend({},e.input,c));var u=a.get("server");e.input.wechat=u&&u.wechat||""}]),angular.module("Feiyi").controller("ordersController",["$scope","$routeParams","$route","$timeout","$filter","$location","weixinServices","userServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a,s,c,u,l,d){e.tab_item=t.type||"1",e.active_tab=function(t){e.tab_item!=t&&(e.tab_item=t,e.page={pn:1,page_size:10,message:"点击加载更多",order_type:e.tab_item},e.no_more=!1,e.orders=[],e.loadMore())},e.orders=[],e.page={pn:1,page_size:10,message:"点击加载更多",order_type:e.tab_item},e.loadMore=function(){e.no_more||(u.show(),e.page.message="正在加载...",s.query_orders(e.page).then(function(t){u.hide(),e.page.message="点击加载更多",t.code==d.request.SUCCESS&&t.status==d.response.SUCCESS?(e.give_jinqi_money=t.give_jinqi_money,e.orders=e.orders.concat(t.Result.OrderList.list),e.no_more=e.orders.length==t.Result.OrderList.totalRow?!0:!1):c.autoHide("服务器错误"),e.no_more&&(e.page.message="没有了"),e.page.pn++}))},e.loadMore(),e.goto_pay=function(e){a.prepare_pay({order_id:e})}}]),angular.module("Feiyi").controller("orderController",["$scope","$routeParams","$filter","userServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a,s){i.show(),n.query_order({orders_id:t.id}).then(function(t){i.hide(),t.code==s.request.SUCCESS&&t.status==s.response.SUCCESS?(e.order=t.Result.Orders,e.order.schedule_from=e.format_time(e.order.order_time.split("#")[0],"MM-dd"),e.order.schedule_to=e.format_time(e.order.order_time.split("#")[e.order.order_time.split("#").length-1],"MM-dd")):r.autoHide(t.message)}),e.format_time=function(e){return e?e.split("-").join("."):void 0},e.replace_hash=function(e){return e&&e.replace(/#/g,"、")},e.parse_time=function(t){return t.split("#").map(function(t){return e.format_time(t,"yyyy.MM.dd")}).join("-")}}]),angular.module("Feiyi").controller("informationDetailController",["$scope","$sce","$routeParams","feiyiServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a,s){i.show(),n.query_information_by_id({news_id:o.id}).then(function(t){i.hide(),t.code==s.request.SUCCESS&&t.status==s.response.SUCCESS?e.info=t.Result.NewsDetailResponse:r.autoHide(t.message)}),e.parse_html=function(e){return t.trustAsHtml(e)}}]),angular.module("Feiyi").controller("informationController",["$scope","$location","feiyiServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a){e.tab_item="1",e.active_tab=function(t){e.tab_item!=t&&(e.tab_item=t,e.page={pn:1,page_size:10,message:"点击加载更多",type:t},e.no_more=!1,e.information=[],e.loadMore())},e.go=function(e){t.path("information_detail").search("id",e)},e.information=[],e.page={pn:1,page_size:10,message:"点击加载更多",type:1},e.loadMore=function(){e.no_more||(r.show(),e.page.message="正在加载...",o.query_information_by_type(e.page).then(function(t){r.hide(),e.page.message="点击加载更多",t.code==a.request.SUCCESS&&t.status==a.response.SUCCESS?(e.information=e.information.concat(t.Result.NewsList.list),e.no_more=e.information.length==t.Result.NewsList.totalRow?!0:!1):n.autoHide("服务器错误"),e.no_more&&(e.page.message="没有了"),e.page.pn++}))},e.loadMore(!1)}]),angular.module("Feiyi").controller("indexController",["$scope","$filter","$rootScope","$location","$timeout","weixinServices","feiyiServices","userServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a,s,c,u,l,d){e.input={},o.wx_browser&&i.config(),u.show(),a.query_province_city_district().then(function(t){u.hide(),e.provinces=t.province,e.input.province=e.provinces[0],e.input.city=e.provinces[0].city[0],e.input.district=e.provinces[0].city[0].district[0]}),e.countdown={message:"获取验证码"},e.countdown.callback=function(){u.show(),s.get_smscode({order_telephone:e.input.telephone}).then(function(t){u.hide(),t.code==d.request.SUCCESS&&t.status==d.response.SUCCESS?c.autoHide(t.message):(e.countdown.reset=!0,c.autoHide(t.message))})},e.choose_image=function(){i.choose_image({},function(t){e.input.preview_disease_image=t[0],e.upload_image(t[0])})},e.upload_image=function(t){i.upload_image({localId:t},function(t){s.upload({mediaId:t}).then(function(t){t.code==d.request.SUCCESS&&t.status==d.response.SUCCESS?e.input.disease_images=t.filename:c.autoHide(t.message)})})},e.remove=function(){e.input.disease_images=""},l.remove("search_cache"),e.ajaxForm=function(){l.set("search_cache",e.input),u.show(),s.booking({province:e.input.province.name,city:e.input.city.name,area:e.input.district.name,hospital_name:e.input.hospital,department:e.input.department,order_name:e.input.username,order_telephone:e.input.telephone,disease_name:e.input.disease_name,disease_content:e.input.disease_content,disease_images:e.input.disease_images,msg_code:e.input.smscode}).then(function(e){u.hide(),e.code==d.request.SUCCESS&&e.status==d.response.SUCCESS?n.path("doctors"):c.autoHide(e.message)})}}]),angular.module("Feiyi").controller("hospitalsController",["$scope","$rootScope","$routeParams","userServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a,s){return e.hospital_keyword=o.hospital_keyword,e.hospital_keyword?(e.hospitals=[],e.page={pn:1,page_size:10,message:"点击加载更多",kw:e.hospital_keyword},e.loadMore=function(){e.no_more||(i.show(),e.page.message="正在加载...",n.query_hospitals(e.page).then(function(t){i.hide(),e.page.message="点击加载更多",t.code==s.request.SUCCESS&&t.status==s.response.SUCCESS?(e.hospitals=e.hospitals.concat(t.Result.HospitalList.list),e.no_more=e.hospitals.length==t.Result.HospitalList.totalRow?!0:!1):r.autoHide("服务器错误"),e.no_more&&(e.page.message="没有了"),e.page.pn++}))},e.loadMore(),void 0):(t.back(),void 0)}]),angular.module("Feiyi").controller("hospitalSearchController",["$scope","$location","errorServices","toastServices","localStorageService","config",function(e,t){e.input={},e.ajaxForm=function(){t.path("hospitals").search("hospital_keyword",e.input.hospital)}}]),angular.module("Feiyi").controller("donateController",["$scope","$rootScope","$timeout","$routeParams","weixinServices","userServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a,s,c,u){e.input={},e.donate_money=n.donate_money,e.ajaxForm=function(){s.show(),i.donate({orders_id:n.order_id,content:e.input.note}).then(function(e){s.hide(),e.code==u.request.SUCCESS&&e.status==u.response.SUCCESS?r.prepare_pay({give_jinqi_id:e.give_jinqi_id}):a.autoHide(e.message)})}}]),angular.module("Feiyi").controller("doctorsController",["$scope","$filter","$location","$routeParams","weixinServices","userServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a,s,c,u){e.input={},c.get("search_cache")&&(e.input=angular.extend({},c.get("search_cache"))),s.show(),i.query_doctors({province:e.input.province.name,city:e.input.city.name,area:e.input.district.name,hospital_name:e.input.hospital,disease_name:e.input.disease_name,department:e.input.department,order_name:e.input.username}).then(function(t){s.hide(),t.code==u.request.SUCCESS&&t.status==u.response.SUCCESS?e.doctors=t.Result.DoctorList:a.autoHide(t.message),e.input.type=e.doctors.length>0?1:3}),e.check_doctor=function(t,o){o.stopPropagation(),o.preventDefault(),e.input.check_doctor_id=t,0==e.input.check_doctor_id&&(e.input.type=2)},e.go=function(e){o.path("doctor").search("doctor_id",e)},e.booking=function(){return"0"==e.input.check_doctor_id?(e.doctors=[],void 0):(s.show(),i.booking_by_doctory_id({doctor_id:e.input.check_doctor_id||"0",province:e.input.province.name,city:e.input.city.name,area:e.input.district.name,hospital_name:e.input.hospital,department:e.input.department,order_name:e.input.username,order_telephone:e.input.telephone,disease_name:e.input.disease_name,disease_content:e.input.disease_content,disease_images:e.input.disease_images||"not found",type:e.input.type}).then(function(e){s.hide(),e.code==u.request.SUCCESS&&e.status==u.response.SUCCESS?r.prepare_pay({order_id:e.orders_id}):a.autoHide(e.message)}),void 0)}}]),angular.module("Feiyi").controller("doctorController",["$scope","$routeParams","$filter","$location","$rootScope","weixinServices","userServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a,s,c,u,l){e.tab_item="doctor_info",e.active_tab=function(t){e.tab_item=t},c.show(),a.query_doctor_by_id({doctor_id:t.doctor_id}).then(function(t){c.hide(),t.code==l.request.SUCCESS&&t.status==l.response.SUCCESS?e.doctor=t.Result.DoctorInfo:s.autoHide(t.message)}),e.comments=[],e.page={pn:1,page_size:10,message:"点击加载更多",doctor_id:t.doctor_id},e.loadMore=function(){e.no_more||(c.show(),e.page.message="正在加载...",a.query_comment_by_doctor(e.page).then(function(t){c.hide(),e.page.message="点击加载更多",t.code==l.request.SUCCESS&&t.status==l.response.SUCCESS?(e.comments=e.comments.concat(t.Result.CommentList.list),e.total_comment_amount=t.Result.CommentList.totalRow,e.no_more=e.comments.length==t.Result.CommentList.totalRow?!0:!1):s.autoHide("服务器错误"),e.no_more&&(e.page.message="没有了"),e.page.pn++}))},e.loadMore()}]),angular.module("Feiyi").controller("commentsController",["$scope","$routeParams","userServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a){r.show(),o.query_comment_by_order({orders_id:t.id}).then(function(t){r.hide(),t.code==a.request.SUCCESS&&t.status==a.response.SUCCESS?e.comment=t.Result.Comment:n.autoHide(t.message)})}]),angular.module("Feiyi").controller("commentController",["$scope","$rootScope","$timeout","$routeParams","userServices","errorServices","toastServices","localStorageService","config",function(e,t,o,n,r,i,a,s,c){e.input={},e.ajaxForm=function(){a.show(),r.comment({orders_id:n.order_id,doctor_id:n.doctor_id,note:e.input.note}).then(function(e){a.hide(),e.code==c.request.SUCCESS&&e.status==c.response.SUCCESS?(i.autoHide(e.message),o(function(){t.back()},2e3)):i.autoHide(e.message)})}}]),angular.module("Feiyi").constant("config",{url:"http://www.orsynsystem.com",imageUrl:"http://www.orsynsystem.com/files/image?name=",request:{SUCCESS:"200",TOKEN_INVALID:"405"},response:{SUCCESS:1},common_params:{invoke:"h5",app_sign:"123456"},interceptor:["index","comment","comments","doctor","doctors","donate","orders","order","information","information_detail","signin","hospitals","hospital_search"]});
//# sourceMappingURL=app.min.js.map
